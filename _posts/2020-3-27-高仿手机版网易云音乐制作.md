---
layout: post
title:  "掘进小册项目过程记录"
date:   2019-12-31
project: true
comments: true
---

购买了神三元的掘金小册《React Hooks 与 Immutable 数据流实战》，开启一个新项目的学习。实现一个高仿的移动端网易云音乐。

**一、路由的配置问题**

在项目开始的时候，最好先从路由开始配置。这样有利于我们对项目的整体了解。在路由的搭建中我们可以自己写类似于下面的配置路由文件：
````js
//routes/index.js
import React from "react"
import {Redirect} from 'react-router-dom';
import Home from "../application/Home";
import Singers from "../application/Singers"
import Recommend from "../application/Recommend";
import Rank from '../application/Rank';

export default[
    {
        path:'/',
        component:Home,
        routes:[
            {path:"/",exact:true,render:()=>(<Redirect to={"/recommend"} />)},
            {path:"/recommend",component:Recommend},
            {path:"/singers",component:Singers},
            {path:"/rank",component:Rank}
        ]
    },
]
````
然后在App.js中引入，并且进行渲染。在渲染的时候，我们需要用到`renderRoutes`这个函数方法（读取路由配置转化为 Route 标签）。它是由`react-router-dom`提供的。这里必须要注意的是：这个函数方法只能渲染一层的配置。以上面的配置代码为例，它只能渲染到第一个配置对象。也就是我们访问到Home组件。

**解决的办法：**

在Home组件中，再次调用`renderRoutes`渲染二级路由界面。如下所示：
````js
import React from 'react';
import { renderRoutes } from "react-router-config";

function Home (props) {
  const { route } = props; //通过解构 取到二级路由配置信息

  return (
    <div>
      <div>Home</div>
      { renderRoutes (route.routes) }
    </div>
  )
}

export default React.memo (Home);
````

**二、路由跳转后对tab选项做样式修改**

很多时候我们都需要点击按钮然后实现路由的跳转，然后同时在这个时候改变我们点击按钮的样式为active。而`react-router-dom`提供了`NavLink`来帮助我们实现这个跳转并切换样式的需求。

使用方法如下：

````js
<NavLink to="跳转地址" activeClassName="selected">路由跳转</NavLink>
````

实际上NavLink也是一个a标签，所以我们进行样式定义的时候。可以使用a标签元素选择器进行样式定义。

**三、使用遮罩的方式设置背景样式**

在轮播背景中，默认是白色的。但是我们需要将它设置为与导航栏一致的颜色。这个时候可以考虑使用一个div标签，制作遮罩的方式，完成对样式的覆盖。

具体代码如下：

````less
  .container{
    position:relative;
    .before{
        position:absolute;
        top:0;
        height: 60%;
        width:100%;
        background:${style['theme-color']};
    }    
  }
````

在父级容器中使用相对定位，在遮罩容器中使用绝对定位。

